<template>
    <lightning-card title="SSRS Assessment" icon-name="standard:survey">
        <template if:false={showResults}>
            <!-- Progress Bar -->
            <div class="slds-p-horizontal_medium slds-p-top_medium">
                <lightning-progress-bar 
                    value={progressPercentage} 
                    size="large"
                    variant="circular">
                </lightning-progress-bar>
                <p class="slds-text-align_center slds-m-top_x-small">
                    Question {questionNumber} of {questionsLength}
                </p>
            </div>

            <!-- Question -->
            <div class="slds-p-around_medium">
                <h2 class="slds-text-heading_medium slds-m-bottom_medium">
                    {currentQuestion.text}
                </h2>

                <!-- Response Options -->
                <lightning-radio-group 
                    name="response"
                    options={responseOptions}
                    value={responses[currentQuestion.id]}
                    onchange={handleResponseChange}
                    type="button">
                </lightning-radio-group>
            </div>

            <!-- Navigation -->
            <div slot="footer" class="slds-grid slds-grid_align-spread">
                <div>
                    <template if:true={canGoBack}>
                        <lightning-button 
                            label="Previous"
                            onclick={handlePrevious}
                            variant="neutral">
                        </lightning-button>
                    </template>
                </div>
                <div>
                    <lightning-button 
                        label={buttonLabel}
                        onclick={handleNext}
                        variant="brand"
                        disabled={isDisabled}>
                    </lightning-button>
                </div>
            </div>

            <!-- Loading -->
            <template if:true={isSubmitting}>
                <lightning-spinner 
                    alternative-text="Processing assessment..."
                    size="large">
                </lightning-spinner>
            </template>
        </template>

        <!-- Results -->
        <template if:true={showResults}>
            <div class="slds-p-around_medium">
                <div class="slds-text-align_center slds-m-bottom_large">
                    <span class={riskLevelClass}>
                        {assessmentResult.riskLevel} Risk
                    </span>
                    <h2 class="slds-text-heading_medium slds-m-top_small">
                        Total Score: {assessmentResult.totalScore}
                    </h2>
                </div>

                <template if:true={assessmentResult.recommendations}>
                    <div class="slds-m-bottom_large">
                        <h3 class="slds-text-heading_small slds-m-bottom_small">
                            Recommendations:
                        </h3>
                        <ul class="slds-list_dotted">
                            <template for:each={assessmentResult.recommendations} for:item="rec">
                                <li key={rec} class="slds-item">{rec}</li>
                            </template>
                        </ul>
                    </div>
                </template>

                <template if:true={assessmentResult.taskCreated}>
                    <div class="slds-notify slds-notify_alert slds-theme_info slds-m-bottom_medium">
                        <span class="slds-assistive-text">Info</span>
                        <h2>A follow-up task has been created for additional documentation.</h2>
                    </div>
                </template>
            </div>

            <div slot="footer" class="slds-text-align_center">
                <lightning-button 
                    label="Start New Assessment"
                    onclick={handleStartOver}
                    variant="neutral">
                </lightning-button>
            </div>
        </template>
    </lightning-card>
</template>